<!doctype html>
<html lang=en>
   <head>
      <meta charset=utf-8>
      <meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1">
      <title>API Reference</title>
      <link rel=icon href=images/bookmark.png>
      <link href=stylesheets/screen.css rel=stylesheet media=screen>
      <link href=stylesheets/print.css rel=stylesheet media=print>
      <link href=stylesheets/highlight-monokai.css rel=stylesheet media=screen,print>
      <script src=javascripts/all.js></script>
   </head>
   <body class="" data-languages="[&#34;json&#34;]">
      <a href=# id=nav-button>
         <span>NAV <img alt=navbar class=image-navbar src=images/navbar.png></span>
      </a>
      <div class=tocify-wrapper>
         <img alt=logo class=image-logo src=images/logo.png>
         <div class=lang-selector>
            <a href=# data-language-name="json">json</a>
         </div>
         <div class=search>
            <input type=text class=search id=input-search placeholder="Search">
         </div>
         <ul class=search-results></ul>
         <div id=toc></div>
         <ul class=toc-footer>
            <li><a href=https://github.com/center-key/node-slate>node-slate on GitHub</a></li>
            <li><a href=https://www.npmjs.com/package/node-slate>Documentation powered by Slate</a></li>
         </ul>
      </div>
      <div class=page-wrapper>
         <div class=dark-box></div>
         <div class=content>
            <h1 id="derivadex-api">DerivaDEX API</h1>
            <p>DerivaDEX is a decentralized derivatives exchange that combines the performance of centralized exchanges with the security of decentralized exchanges.</p>
            <p>DerivaDEX currently offers a public WebSocket API for traders and developers. You must first make a deposit to the DerivaDEX ethereum contracts. The API will then enable you to open and manage your positions via commands, and subscribe to market data via subscriptions. </p>
            <p>Find us online <a href="https://discord.gg/a54BWuG">Discord</a> | <a href="https://t.me/DerivaDEX">Telegram</a> | <a href="https://medium.com/derivadex">Medium</a></p>
            <h1 id="getting-started">Getting Started</h1>
            <p>DerivaDEX is a decentralized exchange. As such, trading is non-custodial. Users are responsible for their own funds, which are deposited to the DerivaDEX smart contracts on Ethereum for trading. </p>
            <p>To begin interacting with the DerivaDEX ecosystem programmatically, you generally will want to follow these steps:</p>
            <ol>
               <li>Deposit funds via Ethereum via an Ethereum client</li>
               <li>Authenticate and connect to the websocket API</li>
               <li>Submit and cancel orders via <code>commands</code></li>
               <li>Subscribe to market and account data feeds via <code>subscriptions</code> </li>
            </ol>
            <p>Additionally, you should familiarize yourself with <a href="https://eips.ethereum.org/EIPS/eip-712">EIP 712 signatures</a>, which is how you will sign <code>command</code> data prior to submission. </p>
            <h2 id="making-a-deposit">Making a deposit</h2>
            <p>To deposit funds on DerivaDEX, first ensure that you have created an Ethereum account. The deposit interaction is between a user and the DerivaDEX smart contracts. To be more explicit, you will not be utilizing the WebSocket API to facilitate a deposit. The DerivaDEX Solidity smart contracts adhere to the <a href="https://medium.com/derivadex/the-diamond-standard-a-new-paradigm-for-upgradeability-569121a08954">Diamond Standard</a>. The <code>deposit</code> smart contract function you will need to use is located in the <code>Trader</code> facet, at the address of the main <code>DerivaDEX</code> proxy contract.</p>
            <pre class="highlight text"><code>// solidity
function deposit(
    address _collateralAddress,
    bytes32 _strategyId,
    uint128 _amount
) external;</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>_collateralAddress</td>
                     <td>ERC-20 token address deposited as collateral</td>
                  </tr>
                  <tr>
                     <td>_strategyId</td>
                     <td>Strategy ID (encoded as a 32-byte value) being funded</td>
                  </tr>
                  <tr>
                     <td>_amount</td>
                     <td>Amount deposited (be sure to use the grains format specific to the collateral token being used (e.g. if you wanted to deposit 1 USDC, you would enter 1000000 since the USDC token contract has 6 decimal places)</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="connecting-to-the-websocket-api">Connecting to the Websocket API</h2>
            <p>Addresses used to connect to the websocket API must <em>already</em> have funds deposited. If you haven&#39;t, [do that first](#Making a deposit).</p>
            <p>The steps to connect are:</p>
            <ol>
               <li>Generate a numeric value (<code>nonce</code>) that is greater than the last value used for this address. Typically, <a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a> (either milliseconds or nanoseconds) is used, but users may opt to maintain their own sequence counter. Requests with a nonce that are less than or equal to the previous value will be rejected.</li>
               <li><code>Keccak-256</code> hash the following ABI-encoded values with the specified types(using <code>Keccak-256</code>):<ul>
                     <li>&quot;DerivaDEX API&quot; (<code>bytes32</code>) </li>
                     <li><code>nonce</code> (<code>uint256</code>)</li>
                  </ul>
               </li>
               <li>Generate a <code>signature</code> of the hash using eth_sign or equivalent signer.</li>
               <li>Connect to the websocket with the url: <code>wss://api.derivadex.com?nonce=[nonce]&amp;signature=[signature]</code></li>
            </ol>
            <p>For more information, see the <a href="samples.md">code samples</a>.</p>
            <h1 id="commands">Commands</h1>
            <p>The websocket API offers commands for placing and canceling orders, as well as withdrawals. Since commands modify system state, these requests must include an <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md">EIP712 signature</a>. Examples are included in the <a href="samples.md">sample code</a>.</p>
            <h2 id="place-order">Place order</h2>
            <p>You can place new orders by specifying specific attributes in the <code>Order</code> command&#39;s request payload. These requests are subject to a set of validations.</p>
            <blockquote>
               <p>Request format:</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Order&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;makerAddress&quot;</span>: <span class="hljs-string">&quot;0x603699848c84529987E14Ba32C8a66DEF67E9eCE&quot;</span>,
      <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>,
      <span class="hljs-attr">&quot;strategy&quot;</span>: <span class="hljs-string">&quot;main&quot;</span>,
      <span class="hljs-attr">&quot;side&quot;</span>: <span class="hljs-string">&quot;Bid&quot;</span>,
      <span class="hljs-attr">&quot;orderType&quot;</span>: <span class="hljs-string">&quot;Market&quot;</span>,
      <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span>,
      <span class="hljs-attr">&quot;amount&quot;</span>: <span class="hljs-string">&quot;123.45&quot;</span>,
      <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-string">&quot;234.56&quot;</span>,
      <span class="hljs-attr">&quot;stopPrice&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
      <span class="hljs-attr">&quot;signature&quot;</span>: <span class="hljs-string">&quot;0x89fb49d2d125adfef56328ee7367d23d1642d2fb6cfdf8843fa94ae7eac9ab23&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>makerAddress</td>
                     <td>Trader&#39;s Ethereum address (same as the one that facilitated the deposit)</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>symbol</td>
                     <td>Name of the market to trade. Currently, this is limited to &#39;ETHPERP&#39;, but new symbols are coming soon!</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>strategy</td>
                     <td>Name of the cross-margined strategy this trade belongs to. Currently, this is limited to the default <code>main</code> strategy, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>side</td>
                     <td>Side of trade, either <code>Bid</code> (buy/long) or an <code>Ask</code> (sell/short)</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>orderType</td>
                     <td>Order type, either <code>Limit</code> or <code>Market</code>. Other order types coming soon!</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>requestID</td>
                     <td>An incrementing numeric identifier for this request</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>amount</td>
                     <td>The order amount/size requested</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>price</td>
                     <td>The order price</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>stopPrice</td>
                     <td>Currently, always 0 as stops are not implemented.</td>
                  </tr>
                  <tr>
                     <td>bytes</td>
                     <td>signature</td>
                     <td>EIP-712 signature</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="cancel-order">Cancel order</h2>
            <p>You can cancel existing orders by specifying specific attributes in the <code>CancelOrder</code> command&#39;s request payload.</p>
            <blockquote>
               <p>Request format:</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;CancelOrder&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>,
      <span class="hljs-attr">&quot;orderHash&quot;</span>: <span class="hljs-string">&quot;0xa2e47f2d462c4368fdae25028447c78118ba349141d0ba945c6f100dfd149029&quot;</span>,
      <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000002&quot;</span>,
      <span class="hljs-attr">&quot;signature&quot;</span>: <span class="hljs-string">&quot;0x89fb49d2d125adfef56328ee7367d23d1642d2fb6cfdf8843fa94ae7eac9ab23&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string</td>
                     <td>symbol</td>
                     <td>Currently always &#39;ETHPERP&#39;. New symbols coming soon!</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>orderHash</td>
                     <td>The hash of the order being canceled</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>requestID</td>
                     <td>An incrementing numeric identifier for this request</td>
                  </tr>
                  <tr>
                     <td>bytes</td>
                     <td>signature</td>
                     <td>EIP-712 signature</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="withdraw">Withdraw</h2>
            <p>You can signal withdrawal intents to the Operators by specifying specific attributes in the <code>Withdraw</code> command&#39;s request payload. While you won&#39;t be able to trade with this collateral you are attempting to withdraw, you will only be able to formally initiate a smart contract withdrawal/token transfer once the epoch in which you signal your withdrawal desire has concluded. </p>
            <blockquote>
               <p>Request format:</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Withdraw&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;traderAddress&quot;</span>: <span class="hljs-string">&quot;0x603699848c84529987E14Ba32C8a66DEF67E9eCE&quot;</span>,
      <span class="hljs-attr">&quot;strategyId&quot;</span>: <span class="hljs-string">&quot;main&quot;</span>,
      <span class="hljs-attr">&quot;currency&quot;</span>: <span class="hljs-string">&quot;0x41082c820342539de44c1b404fead3b4b39e15d6&quot;</span>,
      <span class="hljs-attr">&quot;amount&quot;</span>: <span class="hljs-string">&quot;440.32&quot;</span>,
      <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000003&quot;</span>,
      <span class="hljs-attr">&quot;signature&quot;</span>: <span class="hljs-string">&quot;0x89fb49d2d125adfef56328ee7367d23d1642d2fb6cfdf8843fa94ae7eac9ab23&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>traderAddress</td>
                     <td>Trader&#39;s Ethereum address (same as the one that facilitated the deposit)</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>strategyId</td>
                     <td>Name of the cross-margined strategy this trade belongs to. Currently, this is limited to the default <code>main</code> strategy, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>address</td>
                     <td>currency</td>
                     <td>ERC-20 token address being withdrawn</td>
                  </tr>
                  <tr>
                     <td>uint128</td>
                     <td>amount</td>
                     <td>Amount withdrawn (be sure to use the grains format specific to the collateral token being used (e.g. if you wanted to withdraw 1 USDC, you would enter 1000000 since the USDC token contract has 6 decimal places)</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>requestId</td>
                     <td>An incrementing numeric identifier for this request.</td>
                  </tr>
                  <tr>
                     <td>bytes</td>
                     <td>signature</td>
                     <td>EIP-712 signature</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="receipts">Receipts</h2>
            <p>Each command returns a receipt, which confirms that an Operator has received the request and has sequenced it for processing. The receipt <code>type</code> will be either <code>Received</code> or <code>Error</code>.</p>
            <h3 id="received-successful-receipts">Received (successful) receipts</h3>
            <p>A successful command returns a <code>Received</code> receipt from the Operator. DerivaDEX Operators execute code within a trusted execution environment. The enclaveSignature affirms that this environment has the guaranteed associated with Intel SGX TEEs.</p>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;receipt&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Received&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000003&quot;</span>,
      <span class="hljs-attr">&quot;requestIndex&quot;</span>: <span class="hljs-string">&quot;0x5&quot;</span>,
      <span class="hljs-attr">&quot;enclaveSignature&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>bytes32</td>
                     <td>requestId</td>
                     <td>The requestId supplied in the initial request - can be used to correlate requests with receipts</td>
                  </tr>
                  <tr>
                     <td>??</td>
                     <td>requestIndex</td>
                     <td>A ticket number which guarantees fair sequencing</td>
                  </tr>
                  <tr>
                     <td>bytes</td>
                     <td>enclaveSignature</td>
                     <td>An Operator&#39;s signature which proves secure handling of the request</td>
                  </tr>
               </tbody>
            </table>
            <h3 id="error-failed-receipts">Error (failed) receipts</h3>
            <p>An erroneous command returns an <code>Error</code> receipt from the Operator.</p>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;receipt&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Error&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;Nonces cannot go backwards&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string</td>
                     <td>msg</td>
                     <td>Error message</td>
                  </tr>
               </tbody>
            </table>
            <h1 id="subscriptions">Subscriptions</h1>
            <p>You can subscribe to two different kinds of feeds corresponding to a specific trader&#39;s account or market data with <code>SubscribeAccount</code> or <code>SubscribeMarket</code> requests, respectively.</p>
            <h2 id="account">Account</h2>
            <p>You can subscribe to data feeds corresponding to events for a particular trader&#39;s Ethereum address. The possible account events you can subscribe to are <code>StrategyUpdate</code>, <code>OrdersUpdate</code>, and <code>PositionUpdate</code>. These will be discussed below individually. </p>
            <h2 id="strategy-update-account">Strategy update (account)</h2>
            <p>You can subscribe to updates to their strategy with the <code>StrategyUpdate</code> event. A strategy is a cross-margined account in which you can deposit/withdraw collateral and make trades. Strategies are siloed off from one another. Any updates to the free or frozen collaterals you have (whether it&#39;s from deposits, withdrawals, or realized PNL) will be registered in this feed.</p>
            <p>Upon subscription, you will receive a <code>Partial</code> back, containing a snapshot of your strategy at that moment in time. From then on, you will receive streaming <code>Update</code> messages as appropriate.</p>
            <blockquote>
               <p>Request</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;SubscribeAccount&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;trader&quot;</span>: <span class="hljs-string">&quot;0x603699848c84529987E14Ba32C8a66DEF67E9eCE&quot;</span>,
      <span class="hljs-attr">&quot;strategies&quot;</span>: [<span class="hljs-string">&quot;main&quot;</span>],
      <span class="hljs-attr">&quot;events&quot;</span>: [<span class="hljs-string">&quot;StrategyUpdate&quot;</span>]
    }
  }
}</code></pre>
            <blockquote>
               <p>Partial response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;StrategyUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Partial&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;trader&quot;</span>: <span class="hljs-string">&quot;0xe36ea790bc9d7ab70c55260c66d52b1eca985f84&quot;</span>,
        <span class="hljs-attr">&quot;strategy&quot;</span>: <span class="hljs-string">&quot;main&quot;</span>,
        <span class="hljs-attr">&quot;maxLeverage&quot;</span>: <span class="hljs-string">&quot;20&quot;</span>,
        <span class="hljs-attr">&quot;freeCollateral&quot;</span>: <span class="hljs-string">&quot;1000&quot;</span>,
        <span class="hljs-attr">&quot;frozenCollateral&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-23T20:03:45.850Z&quot;</span>
    }]
}</code></pre>
            <blockquote>
               <p>Update response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;StrategyUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Update&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;trader&quot;</span>: <span class="hljs-string">&quot;0xe36ea790bc9d7ab70c55260c66d52b1eca985f84&quot;</span>,
        <span class="hljs-attr">&quot;strategy&quot;</span>: <span class="hljs-string">&quot;main&quot;</span>,
        <span class="hljs-attr">&quot;maxLeverage&quot;</span>: <span class="hljs-string">&quot;20&quot;</span>,
        <span class="hljs-attr">&quot;freeCollateral&quot;</span>: <span class="hljs-string">&quot;2000&quot;</span>,
        <span class="hljs-attr">&quot;frozenCollateral&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;frozen&quot;</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-23T20:03:45.850Z&quot;</span>
    }]
}</code></pre>
            <p><strong>Request parameters</strong></p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>trader</td>
                     <td>Trader&#39;s Ethereum address (same as the one that facilitated the deposit)</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>strategies</td>
                     <td>Strategies being subscribed to. Currently, the only supported strategy is <code>main</code>, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>events</td>
                     <td>Events being subscribed to. This can be one or more of <code>OrdersUpdate</code>, <code>PositionUpdate</code>, and <code>StrategyUpdate</code></td>
                  </tr>
               </tbody>
            </table>
            <p><strong>Response parameters</strong> - an array of updates per strategy is emitted, with each update defined as follows:</p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>trader</td>
                     <td>Trader&#39;s Ethereum address (same as the one requested)</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>strategy</td>
                     <td>Strategy being subscribed to. Currently, the only supported strategy is <code>main</code>, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>int</td>
                     <td>maxLeverage</td>
                     <td>Maximum leverage for strategy, which impacts the maintenance margin ratio associated to any given trader</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>freeCollateral</td>
                     <td>Collateral available for trading (not to be confused with the <code>Free Collateral</code> displayed on the UI, which is the collateral available to a trader wishing to signal a withdraw intent)</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>frozenCollateral</td>
                     <td>Collateral available for a smart contract withdrawal, but not for trading, since the Operators have received the withdraw intent)</td>
                  </tr>
                  <tr>
                     <td>bool</td>
                     <td>frozen</td>
                     <td>Whether the account and its collateral is frozen or not</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="orders-update-account">Orders update (account)</h2>
            <p>You can subscribe to updates to your open orders with the <code>OrdersUpdate</code> event. Upon subscription, you will receive a <code>Partial</code> back, containing a snapshot of all of your open orders at that moment in time. From then on, you will receive streaming/incremental <code>Update</code> messages with any changes to these orders (due to posting new orders, canceling existing orders, or orders that have been matched in partial or in full).</p>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;SubscribeAccount&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;trader&quot;</span>: <span class="hljs-string">&quot;0x603699848c84529987E14Ba32C8a66DEF67E9eCE&quot;</span>,
      <span class="hljs-attr">&quot;strategies&quot;</span>: [<span class="hljs-string">&quot;main&quot;</span>],
      <span class="hljs-attr">&quot;events&quot;</span>: [<span class="hljs-string">&quot;OrdersUpdate&quot;</span>]
    }
  }
}</code></pre>
            <blockquote>
               <p>Partial response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;OrdersUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Partial&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;orderHash&quot;</span>: <span class="hljs-string">&quot;0x946e4bedf2dd87e5380f32a18d1af19adb4d7ecec3a8a346cb641adc5201e53e&quot;</span>,
        <span class="hljs-attr">&quot;makerAddress&quot;</span>: <span class="hljs-string">&quot;0xe36ea790bc9d7ab70c55260c66d52b1eca985f84&quot;</span>,
        <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>,
        <span class="hljs-attr">&quot;side&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;orderType&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span>,
        <span class="hljs-attr">&quot;amount&quot;</span>: <span class="hljs-string">&quot;10.000000000000000000&quot;</span>,
        <span class="hljs-attr">&quot;remainingAmount&quot;</span>: <span class="hljs-string">&quot;10.000000000000000000&quot;</span>,
        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-string">&quot;521.800000000000000000&quot;</span>,
        <span class="hljs-attr">&quot;stopPrice&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;signature&quot;</span>: <span class="hljs-string">&quot;0x&quot;</span>,
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-24T23:25:41.467Z&quot;</span>
    }]
}</code></pre>
            <blockquote>
               <p>Update response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;OrdersUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Update&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;orderHash&quot;</span>: <span class="hljs-string">&quot;0x946e4bedf2dd87e5380f32a18d1af19adb4d7ecec3a8a346cb641adc5201e53e&quot;</span>,
        <span class="hljs-attr">&quot;makerAddress&quot;</span>: <span class="hljs-string">&quot;0xe36ea790bc9d7ab70c55260c66d52b1eca985f84&quot;</span>,
        <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>,
        <span class="hljs-attr">&quot;side&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;orderType&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;requestId&quot;</span>: <span class="hljs-string">&quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span>,
        <span class="hljs-attr">&quot;amount&quot;</span>: <span class="hljs-string">&quot;10&quot;</span>,
        <span class="hljs-attr">&quot;remainingAmount&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-string">&quot;521.8&quot;</span>,
        <span class="hljs-attr">&quot;stopPrice&quot;</span>: <span class="hljs-string">&quot;0&quot;</span>,
        <span class="hljs-attr">&quot;signature&quot;</span>: <span class="hljs-string">&quot;0x&quot;</span>,
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-24T23:25:41.467Z&quot;</span>
    }]
}</code></pre>
            <p><strong>Request parameters</strong></p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>trader</td>
                     <td>Trader&#39;s Ethereum address (same as the one that facilitated the deposit)</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>strategies</td>
                     <td>Strategies being subscribed to. Currently, the only supported strategy is <code>main</code>, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>events</td>
                     <td>Events being subscribed to. This can be one or more of <code>OrdersUpdate</code>, <code>PositionUpdate</code>, and <code>StrategyUpdate</code></td>
                  </tr>
               </tbody>
            </table>
            <p><strong>Response parameters</strong> - an array of updates per order is emitted, with each update defined as follows:</p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>address</td>
                     <td>orderHash</td>
                     <td>Hash of the order that has changed or is new</td>
                  </tr>
                  <tr>
                     <td>address</td>
                     <td>makerAddress</td>
                     <td>Trader&#39;s Ethereum address associated with this order</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>symbol</td>
                     <td>Name of the market this order belongs to. Currently, this is limited to &#39;ETHPERP&#39;, but new symbols are coming soon!</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>strategy</td>
                     <td>Name of the cross-margined strategy this order belongs to. Currently, this is limited to the default <code>main</code> strategy, but support for multiple strategies is coming soon!</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>side</td>
                     <td>Side of order, either <code>Bid</code> (buy/long) or an <code>Ask</code> (sell/short)</td>
                  </tr>
                  <tr>
                     <td>uint256</td>
                     <td>orderType</td>
                     <td>Order type, either <code>Limit</code> or <code>Market</code>. Other order types coming soon!</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>requestID</td>
                     <td>Numeric identifier for the order</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>amount</td>
                     <td>The original order amount/size requested</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>remainingAmount</td>
                     <td>The order amount/size remaining on the order book</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>price</td>
                     <td>The order price</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>stopPrice</td>
                     <td>Currently, always 0 as stops are not implemented.</td>
                  </tr>
                  <tr>
                     <td>bytes</td>
                     <td>signature</td>
                     <td>EIP-712 signature</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>createdAt</td>
                     <td>Timestamp when order was initially created</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="positions-update-account">Positions update (account)</h2>
            <p>TBD</p>
            <h2 id="market">Market</h2>
            <p>You can subscribe to data feeds corresponding to events for the broader market. The possible market events you can subscribe to at this time are <code>OrderBookUpdate</code> and <code>MarkPriceUpdate</code>. These will be discussed below individually. </p>
            <h2 id="order-book-update-market">Order book update (market)</h2>
            <p>You can subscribe to updates to an L2-order book for any given market with the <code>OrderBookUpdate</code> event. As is typically seen, an order book is a price-time FIFO priority queue market place for you to interact with. Since this is an L2-aggregation, the response will collapse any given price level to the aggregate quantity at that level irrespective of the number of participants or the individual order details that comprise that price level.</p>
            <p>Upon subscription, you will receive a <code>Partial</code> back, containing an L2-aggregate snapshot of the order book at that moment in time. From then on, you will receive streaming/incremental <code>Update</code> messages as appropriate containing only the aggregated price levels that are different (due to the placement of new orders, order cancellation, or liquidations/matches that have taken place). Updates will come in with a reference to the side of the order book and in the form of 2-item lists with the format <code>[price, new aggregate quantity]</code>. A new aggregate quantity of <code>0</code> indicates that the price level is now gone. </p>
            <blockquote>
               <p>Request</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;SubscribeMarket&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;symbols&quot;</span>: [<span class="hljs-string">&quot;ETHPERP&quot;</span>],
      <span class="hljs-attr">&quot;events&quot;</span>: [<span class="hljs-string">&quot;OrderBookUpdate&quot;</span>]
    }
  }
}</code></pre>
            <blockquote>
               <p>Partial response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;OrderBookUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Partial&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;bids&quot;</span>: [
            [<span class="hljs-string">&quot;516.58&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>],
            [<span class="hljs-string">&quot;511.36&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>]
        ],
        <span class="hljs-attr">&quot;asks&quot;</span>: [],
        <span class="hljs-attr">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;1616664308163&quot;</span>,
        <span class="hljs-attr">&quot;nonce&quot;</span>: <span class="hljs-string">&quot;0x1848dbc26865f118d0ea56ecf776ee68b5a9b39e0223d4e322374c087a66a201&quot;</span>,
        <span class="hljs-attr">&quot;aggregationType&quot;</span>: <span class="hljs-string">&quot;0.0001&quot;</span>
    }]
}</code></pre>
            <blockquote>
               <p>Update response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;OrderBookUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Partial&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;bids&quot;</span>: [
            [<span class="hljs-string">&quot;516.58&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>]
        ],
        <span class="hljs-attr">&quot;asks&quot;</span>: [
            [<span class="hljs-string">&quot;527.01&quot;</span>, <span class="hljs-string">&quot;10&quot;</span>]
        ],
        <span class="hljs-attr">&quot;timestamp&quot;</span>: <span class="hljs-string">&quot;1616667513875&quot;</span>,
        <span class="hljs-attr">&quot;nonce&quot;</span>: <span class="hljs-string">&quot;0xc423f94e3ba40527b7bed2925cfedabf8a68388bde06f090a772b8bf3c791f5f&quot;</span>,
        <span class="hljs-attr">&quot;aggregationType&quot;</span>: <span class="hljs-string">&quot;0.0001&quot;</span>
    }]
}</code></pre>
            <p><strong>Request parameters</strong></p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string[]</td>
                     <td>symbols</td>
                     <td>Symbols being subscribed to. Currently, the only supported symbol is <code>ETHPERP</code>, but support for more symbols is coming soon!</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>events</td>
                     <td>Events being subscribed to. This can be one or more of <code>OrderBookUpdate</code> and <code>MarkPriceUpdate</code></td>
                  </tr>
               </tbody>
            </table>
            <p><strong>Response parameters</strong> - an array of updates per order book is emitted, with each update defined as follows:</p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>Decimal[2][]</td>
                     <td>bids</td>
                     <td>The price and corresponding updated aggregate quantity for the bids</td>
                  </tr>
                  <tr>
                     <td>Decimal[2][]</td>
                     <td>asks</td>
                     <td>The price and corresponding updated aggregate quantity for the asks</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>timestamp</td>
                     <td>Timestamp of order book partial/update</td>
                  </tr>
                  <tr>
                     <td>bytes32</td>
                     <td>nonce</td>
                     <td>???</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>aggregationType</td>
                     <td>???</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="mark-price-update-market">Mark price update (market)</h2>
            <p>You can subscribe to updates to the mark price for any given market with the <code>MarkPriceUpdate</code> event. The mark price is an important concept on DerivaDEX as it is the price at which positions are marked when displaying unrealized PNL. Consequently, the mark price helps determine a strategy&#39;s margin fraction, thereby triggering liquidations when appropriate. The mark price is computed based on a 30s exponential moving average (often referred to as a 30s EMA) of the spread between the underlying price (a composite of several spot price feeds for the underlying asset) and the DerivaDEX order book itself. </p>
            <p>Upon subscription, you will receive a <code>Partial</code> back, containing a mark price snapshot at that moment in time. From then on, you will receive streaming/incremental <code>Update</code> messages as appropriate. </p>
            <blockquote>
               <p>Request</p>
            </blockquote>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;request&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;SubscribeMarket&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;symbols&quot;</span>: [<span class="hljs-string">&quot;ETHPERP&quot;</span>],
      <span class="hljs-attr">&quot;events&quot;</span>: [<span class="hljs-string">&quot;MarkPriceUpdate&quot;</span>]
    }
  }
}</code></pre>
            <blockquote>
               <p>Partial response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;MarkPriceUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Partial&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-string">&quot;508.36236848846397&quot;</span>,
        <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>,
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-25T10:37:38.124Z&quot;</span>,
        <span class="hljs-attr">&quot;updatedAt&quot;</span>: <span class="hljs-string">&quot;2021-03-25T10:37:38.124Z&quot;</span>
    }]
}</code></pre>
            <blockquote>
               <p>Update response</p>
            </blockquote>
            <pre class="highlight json"><code>{
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;MarkPriceUpdate&quot;</span>,
    <span class="hljs-attr">&quot;e&quot;</span>: <span class="hljs-string">&quot;Update&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: [{
        <span class="hljs-attr">&quot;createdAt&quot;</span>: <span class="hljs-string">&quot;2021-03-25T10:38:09.503654+00:00&quot;</span>,
        <span class="hljs-attr">&quot;updatedAt&quot;</span>: <span class="hljs-string">&quot;2021-03-25T10:38:09.503654+00:00&quot;</span>,
        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-string">&quot;508.95189310211146&quot;</span>,
        <span class="hljs-attr">&quot;symbol&quot;</span>: <span class="hljs-string">&quot;ETHPERP&quot;</span>
    }]
}</code></pre>
            <p><strong>Request parameters</strong></p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string[]</td>
                     <td>symbols</td>
                     <td>Symbols being subscribed to. Currently, the only supported symbol is <code>ETHPERP</code>, but support for more symbols is coming soon!</td>
                  </tr>
                  <tr>
                     <td>string[]</td>
                     <td>events</td>
                     <td>Events being subscribed to. This can be one or more of <code>OrderBookUpdate</code> and <code>MarkPriceUpdate</code></td>
                  </tr>
               </tbody>
            </table>
            <p><strong>Response parameters</strong> - an array of updates per order book is emitted, with each update defined as follows:</p>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string</td>
                     <td>createdAt</td>
                     <td>Timestamp of original mark price entry</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>updatedAt</td>
                     <td>Timestamp of mark price update</td>
                  </tr>
                  <tr>
                     <td>Decimal</td>
                     <td>price</td>
                     <td>Mark price for the market</td>
                  </tr>
                  <tr>
                     <td>string</td>
                     <td>symbol</td>
                     <td>Market subscribed to</td>
                  </tr>
               </tbody>
            </table>
            <h2 id="receipts-1">Receipts</h2>
            <p>Each subscription returns a receipt, which confirms that an Operator has received the subscription request. The receipt <code>type</code> will be either <code>Subscribed</code> or <code>Error</code>.</p>
            <h3 id="subscribed-successful-receipts">Subscribed (successful) receipts</h3>
            <p>A successful subscription returns a <code>Subscribed</code> receipt from the Operator.</p>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;receipt&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Subscribed&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;Subscribed to OrderBookUpdate for ETHPERP&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string</td>
                     <td>msg</td>
                     <td>Success message</td>
                  </tr>
               </tbody>
            </table>
            <h3 id="error-failed-receipts-1">Error (failed) receipts</h3>
            <p>An erroneous subscription returns an <code>Error</code> receipt from the Operator.</p>
            <pre class="highlight json"><code>{
  <span class="hljs-attr">&quot;receipt&quot;</span>: {
    <span class="hljs-attr">&quot;t&quot;</span>: <span class="hljs-string">&quot;Error&quot;</span>,
    <span class="hljs-attr">&quot;c&quot;</span>: {
      <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;Invalid subscription&quot;</span>
    }
  }
}</code></pre>
            <table>
               <thead>
                  <tr>
                     <th>type</th>
                     <th>field</th>
                     <th>description</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>string</td>
                     <td>msg</td>
                     <td>Error message</td>
                  </tr>
               </tbody>
            </table>
            <h1 id="validation">Validation</h1>
            <p>TBD</p>
            <h1 id="rate-limits">Rate Limits</h1>
            <p>The websocket API will (eventually) use tiers to determine rate limits for each ethereum account. Rate limits restrict the number of &quot;Commands&quot; an account can place per minute.</p>
            <p>Subscriptions are not rate limited.</p>
            <h1 id="errors">Errors</h1>
            <aside class=error> This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files...just save them to the `includes` folder and add them to the top of your `index.md`'s front matter. Files are included in the order listed. </aside>
            <p>The DerivaDEX API uses the following error codes:</p>
            <p>TBD</p>
         </div>
         <div class=dark-box>
            <div class=lang-selector>
               <a href=# data-language-name="json">json</a>
            </div>
         </div>
      </div>
   </body>
</html>